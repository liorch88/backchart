/*! Backchart - v0.1.0 - 2014-02-15
* https://github.com/xch89820/backchart
* Copyright (c) 2014 xu.chenhui; Licensed MIT */
!function(a,b,c){"use strict";if("function"==typeof define&&define.amd)define(["jquery","backbone"],function(a,b){return c(a,b)});else if("undefined"!=typeof module&&module.exports){var d=require("jquery"),e=require("backbone");module.exports=c(d,e)}else for(var f=b.split("."),g=a||this,h=0;h<f.length;h++){var i=f[h],j=g[i];g=g[i]=h===f.length-1?c(a.jQuery||window.jQuery,a.Backbone||window.Backbone):j||{}}}(this,"backchart.base.model",function(a,b){var c=b.Model.extend({});return c}),function(a,b,c){"use strict";if("function"==typeof define&&define.amd)define(["jquery","backbone"],function(a,b){return c(a,b)});else if("undefined"!=typeof module&&module.exports){var d=require("jquery"),e=require("backbone");module.exports=c(d,e)}else for(var f=b.split("."),g=a||this,h=0;h<f.length;h++){var i=f[h],j=g[i];g=g[i]=h===f.length-1?c(a.jQuery||window.jQuery,a.Backbone||window.Backbone):j||{}}}(this,"backchart.base.collection",function(a,b){var c=b.Collection.extend({_backchart:!0,initialize:function(){return this._silence=!1,b.Collection.prototype.initialize.apply(this,arguments)},setSilence:function(a){this._silence=a},set:function(a,c){if(this._silence===!0)return b.Collection.prototype.set.apply(this,arguments);this.setSilence(!0);var d=b.Collection.prototype.set.apply(this,arguments);return this.setSilence(!1),this.trigger("seted",this.models,this,c),d},remove:function(a,c){if(this._silence===!0)return b.Collection.prototype.remove.apply(this,arguments);this.setSilence(!0);var d=b.Collection.prototype.remove.apply(this,arguments);return this.setSilence(!1),this.trigger("removed",this.models,this,c),d},reset:function(a,c){if(this._silence===!0)return b.Collection.prototype.reset.apply(this,arguments);this.setSilence(!0);var d=b.Collection.prototype.reset.apply(this,arguments);return this.setSilence(!1),this.trigger("reseted",this,c),d}});return c}),function(a,b,c){"use strict";if("function"==typeof define&&define.amd)define(["jquery","backbone","underscore"],function(a,b,d){return c(a,b,d)});else if("undefined"!=typeof module&&module.exports){var d=require("jquery"),e=require("underscore"),f=require("backbone");module.exports=c(d,f,e)}else for(var g=b.split("."),h=a||this,i=0;i<g.length;i++){var j=g[i],k=h[j];h=h[j]=i===g.length-1?c(a.jQuery||window.jQuery,a.Backbone||window.Backbone,a._||window._):k||{}}}(this,"backchart.base.view",function(a,b,c){var d=b.View.extend({tagName:"div",className:"backchart",_collectionPrefix:"_cname",container:null,eventCallback:{"default":"render"},_getEventCallback:function(a){var b=this.eventCallback[a]||this.eventCallback["default"];return b?this[b]:this.render},setSilence:function(a){this._silence=a},_setVisible:function(a,c){var d=this;if("string"==typeof a||a instanceof String){var e=d._collectionOptions[a];e&&(e.visible=c)}else a instanceof b.Collection&&d.eachCollection(function(b,d,e,f){d===a&&(f.visible=c)});return d.render(),d},hide:function(a){return this._setVisible(a,!1)},show:function(a){return this._setVisible(a,!0)},isVisibled:function(a){var c=this;if("string"==typeof a||a instanceof String){var d=c._collectionOptions[a];return d?d.visible:!1}if(a instanceof b.Collection){var e={};return c.eachCollection(function(b,c,d,f){c===a&&(e[b]=f?f.visible:!1)}),e}},initialize:function(){var a=this;a._silence=!1,b.View.prototype.initialize.apply(this,arguments),a.collections={},a._collectionOptions={},a._collectionRenderOptions={},this.on("collection.on",function(b,c,d,e){e.renderAfterOn===!0&&a.render()}),this.on("collection.off",function(){a.render()})},__bce:function(a,b,d){var e=this;c.each(b,function(a){e.listenTo(d,a,e._getEventCallback(a))})},__ubce:function(a,b,d){var e=this;c.each(b,function(a){d.off(a,e._getEventCallback(a))})},_getBindEvents:function(a){var b=["set","add","change","destroy","reset","sort"];return"undefined"!=typeof a._backchart&&(b=["seted","removed","change","destroy","reseted","sort"]),b},_bindCollectionEvent:function(a,b,c){c.silence!==!0&&this.__bce(a,this._getBindEvents(b),b)},_unbindColletionEvent:function(a,b){this.__ubce(a,this._getBindEvents(b),b)},_collectionHasBind:function(a){for(var b in this.collections)if(this.collections[b]===a)return!0;return!1},onCollection:function(a,d,e){d=d||{},e=e||{};var f=this,g=e.bid||c.uniqueId(f._collectionPrefix);if(!(!a instanceof b.Collection)){f._collectionHasBind(a)||(f._bindCollectionEvent(g,a,e),f.trigger("collection.bindEvent",a)),f.collections[g]=a;var h=c.clone(d);return f._collectionOptions[g]=e,f._collectionRenderOptions[g]=h,f.trigger("collection.on",g,a,h,e),g}},onCollections:function(a,b,d){var e=this;!a instanceof Array&&(a=[a]);var f={};return c.each(a,function(a){f[a]=e.onCollection(a,b,d)}),f},unCollection:function(a){var d=this,e=null;if("string"==typeof a||a instanceof String){if(e=d.collections[a]){delete d.collections[a];var f=d._collectionRenderOptions[a],g=d._collectionOptions[a];delete d._collectionRenderOptions[a],delete d._collectionOptions[a],d._collectionHasBind(e)||(d._unbindColletionEvent(a,e),d.trigger("collection.unbindEvent",e)),d.trigger("collection.off",a,e,f,g)}return e}if(a instanceof b.Collection){var h=[];e=a;for(var i in d.collections)d.collections[i]===e&&h.push(i);return c.each(h,function(a){d.unCollection(a)}),e}},clearCollection:function(){var a=this,b=c.keys(this.collections);return c.each(b,function(b){a.unCollection(b)}),this},eachCollection:function(a){var b=this;for(var c in b.collections)a.call(b.collections[c],c,b.collections[c],b._collectionRenderOptions[c],b._collectionOptions[c])},getCollection:function(a){var d=this;if("boolean"==typeof a&&a===!1)return c.uniq(c.values(d.collections));if("string"==typeof a||a instanceof String)return d.collections[a];if(a instanceof b.Collection){var e=[];return d.eachCollection(function(b){this===a&&e.push(b)}),e}var f={};return d.eachCollection(function(a){"undefined"==typeof f[this]&&(f[this]=[]),f[this].push(a)}),f},getOptions:function(a){var c=this,d=null;return"string"==typeof a||a instanceof String?c._collectionOptions[a]:a instanceof b.Collection?(d=[],c.eachCollection(function(b,c,e,f){c===a&&d.push(f)}),d):(d={},c.eachCollection(function(a,b,c,e){"undefined"==typeof d[this]&&(d[this]=[]),d[this].push(e)}),d)},getRenderOptions:function(a){var c=this,d=[];return"string"==typeof a||a instanceof String?c._collectionRenderOptions[a]:a instanceof b.Collection?(d=[],c.eachCollection(function(b,c,e){c===a&&d.push(e)}),d):(d={},c.eachCollection(function(a,b,c){"undefined"==typeof d[this]&&(d[this]=[]),d[this].push(c)}),d)},render:function(){var b=this;if(b.container)return b.$container=a(b.container),b.$container.is(":hidden")?!1:b._silence===!0?!1:!0},renderEvents:function(){this.trigger.apply(this,["view.rendered"].concat(arguments)),a(this.container).trigger("backchart.rendered",arguments)},elFillParents:function(){this.$el.css({width:"100%",height:"100%"})}});return d}),function(a,b,c){"use strict";if("function"==typeof define&&define.amd)define(["jquery","../backchart.base/model"],function(a,b){return c(a,b)});else if("undefined"!=typeof module&&module.exports){var d=require("jquery"),e=require("../backchart.base/model");module.exports=c(d,e)}else for(var f=b.split("."),g=a||this,h=0;h<f.length;h++){var i=f[h],j=g[i];g=g[i]=h===f.length-1?c(a.jQuery||window.jQuery,a.backchart.base.model):j||{}}}(this,"backchart.canvasjs.model",function(a,b){var c=b.extend({_setAlias:function(a,b,c){"undefined"!=typeof a[b]&&(a[c]=a[b])},constructor:function(a,c){return c=c||{},c.parse=this.parse,b.prototype.constructor.apply(this,[a,c])},parse:function(a){return this.xField&&(this._setAlias(a,this.xField,"x"),this.timestamp&&(a.x=1e3*a.x)),this.yField&&this._setAlias(a,this.yField,"y"),this.labelField&&("string"==typeof this.labelField?this._setAlias(a,this.labelField,"label"):"function"==typeof this.labelField&&this.labelField.call(a)),a}});return c}),function(a,b,c){"use strict";if("function"==typeof define&&define.amd)define(["jquery","../backchart.base/collection"],function(a,b){return c(a,b)});else if("undefined"!=typeof module&&module.exports){var d=require("jquery"),e=require("../backchart.base/collection");module.exports=c(d,e)}else for(var f=b.split("."),g=a||this,h=0;h<f.length;h++){var i=f[h],j=g[i];g=g[i]=h===f.length-1?c(a.jQuery||window.jQuery,a.backchart.base.collection):j||{}}}(this,"backchart.canvasjs.collection",function(a,b){return b}),function(a,b,c){"use strict";if("function"==typeof define&&define.amd)define(["jquery","../backchart.base/view","backbone","underscore","CanvasJS"],function(a,b,d,e,f){return f=f||window.CanvasJS,c(a,d,e,b,f)});else if("undefined"!=typeof module&&module.exports){var d=require("jquery"),e=require("../backchart.base/view"),f=require("backbone"),g=require("underscore"),h=require("CanvasJS")||window.CanvasJS;module.exports=c(d,f,g,e,h)}else for(var i=b.split("."),j=a||this,k=0;k<i.length;k++){var l=i[k],m=j[l];j=j[l]=k===i.length-1?c(a.jQuery||window.jQuery,a.Backbone||window.Backbone,a._||window._,a.backchart.base.view,a.CanvasJS||window.CanvasJS):m||{}}}(this,"backchart.canvasjs.view",function(a,b,c,d,e){var f=d.extend({defaultRenderOptions:{type:"column"},initialize:function(b,c){d.prototype.initialize.apply(this,arguments),this.defaultOptions=a.extend(!0,{},this.defaultOptions,b),this.defaultRenderOptions=a.extend(!0,{},this.defaultRenderOptions,c)},transformData:function(b,d){var e=this,f=[],g=a.extend(!0,{},e.defaultRenderOptions,d);return b.each(function(a){var b=c.clone(a.attributes);f.push(b)}),g.dataPoints=f,g},render:function(){var a=this,b=d.prototype.render.apply(a,arguments);if(!b)return!1;a.el.id||(a.el.id=c.uniqueId("backchartel"));var f=c.clone(a.defaultOptions);f.data=[],a.eachCollection(function(b,c,d,e){c._silence||e.visible===!1||f.data.push(a.transformData(c,d))}),a.$container.empty().append(a.$el.empty()),a.elFillParents(),a.Chart=new e.Chart(a.el.id,f),a.Chart.render(),d.prototype.renderEvents.apply(a,[a,a.el,a.Chart,f])}});return f});